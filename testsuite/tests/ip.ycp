{

include "testsuite.ycp";
include "network/ip.ycp";

DUMP("check_ip4");
TEST(``(check_ip4(nil)), [], nil);
TEST(``(check_ip4("")), [], nil);
TEST(``(check_ip4("A.1.2.3")), [], nil);
TEST(``(check_ip4("1.2.3")), [], nil);
TEST(``(check_ip4("1..2.34")), [], nil);
TEST(``(check_ip4("1. .2.34")), [], nil);
TEST(``(check_ip4("255.255.256.255")), [], nil);
TEST(``(check_ip4("127")), [], nil);
TEST(``(check_ip4("----------")), [], nil);
TEST(``(check_ip4("127.0.0.1")), [], nil);
TEST(``(check_ip4("255.255.255.0")), [], nil);
TEST(``(check_ip4("255.255.255.255")), [], nil);
TEST(``(check_ip4("192.168.0.1")), [], nil);
TEST(``(check_ip4("195.113.31.123")), [], nil);
TEST(``(check_ip4("255.0.0.1")), [], nil);
TEST(``(check_ip4("10.20.1.29")), [], nil);
TEST(``(check_ip4("1.2.3.4")), [], nil);
TEST(``(check_ip4("0.0.0.0")), [], nil);

DUMP("check_ip6");
TEST(``(check_ip6(nil)), [], nil);
TEST(``(check_ip6("")), [], nil);
TEST(``(check_ip6("1:1:1:01:1:1:1:1")), [], nil);
TEST(``(check_ip6("----------")), [], nil);
TEST(``(check_ip6("fec0:1:2:0:200:1cff:feb5:a7ea")), [], nil);
//TEST(``(check_ip6("fe80::200:1cff:feb5:a7ea")), [], nil);
//TEST(``(check_ip6("fe80::1cb5:a7ea")), [], nil);
//TEST(``(check_ip6("::1")), [], nil);

DUMP("check_netmask");
TEST(``(check_netmask("128.0.0.0")), [], nil);
TEST(``(check_netmask("192.0.0.0")), [], nil);
TEST(``(check_netmask("224.0.0.0")), [], nil);
TEST(``(check_netmask("240.0.0.0")), [], nil);
TEST(``(check_netmask("248.0.0.0")), [], nil);
TEST(``(check_netmask("252.0.0.0")), [], nil);
TEST(``(check_netmask("254.0.0.0")), [], nil);
TEST(``(check_netmask("255.0.0.0")), [], nil);
TEST(``(check_netmask("255.128.0.0")), [], nil);
TEST(``(check_netmask("255.192.0.0")), [], nil);
TEST(``(check_netmask("255.224.0.0")), [], nil);
TEST(``(check_netmask("255.240.0.0")), [], nil);
TEST(``(check_netmask("255.248.0.0")), [], nil);
TEST(``(check_netmask("255.252.0.0")), [], nil);
TEST(``(check_netmask("255.254.0.0")), [], nil);
TEST(``(check_netmask("255.255.0.0")), [], nil);
TEST(``(check_netmask("255.255.128.0")), [], nil);
TEST(``(check_netmask("255.255.192.0")), [], nil);
TEST(``(check_netmask("255.255.224.0")), [], nil);
TEST(``(check_netmask("255.255.240.0")), [], nil);
TEST(``(check_netmask("255.255.248.0")), [], nil);
TEST(``(check_netmask("255.255.252.0")), [], nil);
TEST(``(check_netmask("255.255.254.0")), [], nil);
TEST(``(check_netmask("255.255.255.0")), [], nil);
TEST(``(check_netmask("255.255.255.128")), [], nil);
TEST(``(check_netmask("255.255.255.192")), [], nil);
TEST(``(check_netmask("255.255.255.224")), [], nil);
TEST(``(check_netmask("255.255.255.240")), [], nil);
TEST(``(check_netmask("255.255.255.248")), [], nil);
TEST(``(check_netmask("255.255.255.252")), [], nil);
TEST(``(check_netmask("255.255.255.254")), [], nil);
TEST(``(check_netmask("255.255.255.255")), [], nil);
TEST(``(check_netmask("1.2.3.4")), [], nil);
TEST(``(check_netmask("1.A.3.4")), [], nil);
TEST(``(check_netmask("0.0.0.0")), [], nil);

//TEST(``(check_netmask("24")), [], nil);
//ipv6 netmasks:
//TEST(``(check_netmask("128")), [], nil);
//TEST(``(check_netmask("64")), [], nil);
//TEST(``(check_netmask("10")), [], nil);

DUMP("ip2integer");
TEST(``(ip2integer("0.0.0.0")), [], nil);
TEST(``(ip2integer("127.0.0.1")), [], nil);
TEST(``(ip2integer("192.168.110.23")), [], nil);
TEST(``(ip2integer("10.20.1.29")), [], nil);

DUMP("ip2string");
TEST(``(ip2string(0)), [], nil);
TEST(``(ip2string(2130706433)), [], nil);
TEST(``(ip2string(3232263703)), [], nil);
TEST(``(ip2string(169083165)), [], nil);

DUMP("ip2hex");
TEST(``(ip2hex("0.0.0.0")), [], nil);
TEST(``(ip2hex("192.168.1.1")), [], nil);
TEST(``(ip2hex("255.255.255.255")), [], nil);

DUMP("compute_network");
TEST(``(compute_network("127.0.0.1","255.0.0.0")), [], nil);
TEST(``(compute_network("192.168.110.23","255.255.255.0")), [], nil);
TEST(``(compute_network("10.20.1.29","255.255.240.0")), [], nil);

DUMP("compute_broadcast");
TEST(``(compute_broadcast("127.0.0.1","255.0.0.0")), [], nil);
TEST(``(compute_broadcast("192.168.110.23","255.255.255.0")), [], nil);
TEST(``(compute_broadcast("10.20.1.29","255.255.240.0")), [], nil);

}
