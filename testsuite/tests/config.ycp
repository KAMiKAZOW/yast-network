{

include "testsuite.ycp";

map CONFIG = $[];
map READ = $[];

READ = $[
    "network" : $[
	"section" : $[
	    "eth0" : nil,
	    //"eth0:1" : nil,
	    "eth1" : nil,
	    "ppp2" : nil,
	    "ippp3" : nil,
	    "ppp5.bak" : nil,
	    "pcmcia" : nil,
	    // "pcmcia" : nil, -> brakes regexpsub without check
	],
	"value" : $[
	    "eth0" : $[ "IPADDR" : "0"],
	    //"eth0:1" : $[ "IPADDR" : "0:1"],
	    "eth1" : $[ "IPADDR" : "1"],
	    "ppp2" : $[ "IPADDR" : "2"],
	    "ippp3" : $[ "IPADDR" : "3"],
	],
    ],
    "probe" : $[
	"system" : [],
    ],
];

TESTSUITE_INIT([READ], nil);

include "network/config.ycp";

DUMP("ReadConfig");
TEST(``(ReadConfig("")), [READ], nil);
DUMP(sformat("all=%1",CONFIG));
TEST(``(ReadConfig("eth")), [READ], nil);
DUMP(sformat("eth=%1",CONFIG));
TEST(``(ReadConfig("ppp")), [READ], nil);
DUMP(sformat("ppp=%1",CONFIG));
TEST(``(ReadConfig("ippp")), [READ], nil);
DUMP(sformat("ippp=%1",CONFIG));
TEST(``(ReadConfig("tr")), [READ], nil);
DUMP(sformat("tr=%1",CONFIG));
TEST(``(ReadConfig("ppp|eth")), [READ], nil);
DUMP(sformat("ppp|eth=%1",CONFIG));
TEST(``(ReadConfig("eth|tr")), [READ], nil);
DUMP(sformat("eth|tr=%1",CONFIG));

DUMP("LocateDevices");
CONFIG=$[ "eth" : $[ "0" : $[ "BOOTPROTO" : "dhcp" ]]];
TEST(``(LocateDevices("BOOTPROTO", "dhcp")), [], nil);
CONFIG=$[ "eth" : $[ "0" : $[ "BOOTPROTO" : "" ]]];
TEST(``(LocateDevices("BOOTPROTO", "dhcp")), [], nil);
CONFIG=$[ "eth" : $[ "0" : $[ "BOOTPROTO" : "static" ]]];
TEST(``(LocateDevices("BOOTPROTO", "dhcp")), [], nil);
CONFIG=$[ "eth" : $[ "0" : $[ "BOOTPROTO" : "static" ], "1" : $[ "BOOTPROTO" : "dhcp"]]];
TEST(``(LocateDevices("BOOTPROTO", "dhcp")), [], nil);
CONFIG=$[ "eth" : $[ "0" : $[ "BOOTPROTO" : "static" ]], "tr" : $["1" : $[ "BOOTPROTO" : "dhcp"]]];
TEST(``(LocateDevices("BOOTPROTO", "dhcp")), [], nil);

}
